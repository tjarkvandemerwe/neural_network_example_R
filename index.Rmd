---
# title: "Neural Network Example in R"
output: 
  github_document:
    html_preview: false
    toc: true
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Setup

### Goal
The goal is to create a working example of a basic deep neural network in R.
This example uses the tidyverse style of R. The main goal is clarity and explaining the concept, not speed or practical application.

### Packages
```{r library, message = FALSE, warning = FALSE}
library(tidyverse)
```


### Training data
The training data used in this example is fake data. And this example starts of with an output that is lineairly related to an input variable.
```{r fake_data, message = FALSE, warning = FALSE}
data <- tibble(
  input_value = c(0:10) / 10,
  output_value = c(0:10) / -5 + 1
)

data |> head(7)
```


### Setup neural network
```{r nn_parameters, message = FALSE, warning = FALSE}
input_neurons  <- 1
output_neurons <- 1
layers         <- 1
layer_neurons  <- 2


nn <- list(
  w_input = matrix(sample(0:100 / 100, layer_neurons * input_neurons), nrow = 1)
)

if(layers > 1){
  for(n in 1:(layers - 1)){
    a <- list(matrix(sample(0:100 / 100, layer_neurons * layer_neurons), nrow = layer_neurons))
    names(a) <- paste0("w_hidden_layer_", n)
    nn <- c(nn, a)
  }
}

nn <- c(nn,
        list(w_output = matrix(
          sample(0:100 / 100, layer_neurons * output_neurons), ncol = 1
        )))


nn
```


# Forward propagation
